
The following section provides details of the various MVAs as well as a few studies performed in support of this analysis, exploring alternate decisions and strategies. 

%-------------------------------------------------                                                                           
\subsection{Truth Level Studies}
\label{sec:truthPtStudies}
%-------------------------------------------------                                                                          
  
Attempts to identify the decay products of the Higgs are motivated by the ability to reconstruct the Higgs momentum based on their kinematics. In order to demonstrate that this is case, the kinematics of reconstructed objects that are truth matched to the Higgs decay are used as inputs to a neural network which is designed to predict of the momentum of the Higgs. This is done in the $2lSS$ channel, as it proves to be the most challenging for $p_T$ reconstruction. 

Only leptons and jets which are truth matched to the Higgs are used as inputs for the model; events where the lepton and both jets are not reconstructed are not included. The model uses the same feature set and network architecture as the $p_T$ prediction model used in the main analysis, as described in Section \ref{subsec:pt2lSS}.

The results of the model are summarized below:

\begin{figure}[H]
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/truthHiggsTop2lSS/keras_test_pt_scatter.png}}%   
    \subfigure[]{\includegraphics[width=.56\linewidth]{ptReco/truthHiggsTop2lSS/keras_test_norm2Dhist.png}}\\
    \caption{The regressed Higgs momentum spectrum as a function of the truth $p_T$ for 2lSS $t\bar{t}H$ events in (a) a scatterplot, where the color of each point represents the log of the point density, based on Gaussian Kernal Density Estimation, and (b) a histogram where each column  has been normalized to one.}
    \label{fig:truth2lSSresults}
\end{figure}

\begin{figure}[H]
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/truthHiggsTop2lSS/keras_score.png}}%                
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/truthHiggsTop2lSS/keras_roc.png}}\\
    \caption{(a) shows the reconstructed Higgs $p_T$ for 2lSS events with truth $p_T > $ 150 GeV and $<$ 150 GeV, while (b) shows the ROC curve for those two sets of events.}
    \label{fig:truth2lSSroc}
\end{figure}

Based on the performance of the model, as shown Figures \ref{fig:truth2lSSresults} and \ref{fig:truth2lSSroc}, the Higgs momentum can be reconstructed with fairly high precision when its decay products are correctly identified.

%---------------------------------------------------------------------- 
\subsection{Alternate b-jet Identification Algorithm}
\label{subsec:topRecoApx}
%---------------------------------------------------------------------- 

The nominal analysis reconstructs the b-jets by considering different combinations of jets, and asking a neural network to determine whether each combination consists of b-jets from top quark decays. An alternate approach would be to give the neural network about all of the jets in an event at once, and train it to select which two are most likely to be the b-jets from top decay. It was hypothesized that this could perform better than considering each combination independently, as the neural network could consider the event as a whole. While this is not found to be the case, these studies are documented here as a point of interest and comparison.

For these studies, the kinematics of the 10 highest $p_T$ jets in each event are used for training. This includes the vast majority of truth b-jets. Specifically the $p_T$, $\eta$, $\phi$, $E$, and DL1r score of each jet are used. For events with fewer than 10 jets, these values are substituted with 0. The $p_T$, $\eta$, $\phi$, and $E$ of the leptons and $E_T^{miss}$ are included as well. Caterogical cross entropy is used as the loss function.

\begin{table}[H]
  \centering
  \caption{Accuracey of the NN in identifying b-jets from tops in 2lSS events for the alternate categorical method compared to the nominal method.}
  \begin{tabular}{l|c|c}                                                                                                     
  \hline\hline
  Channel & Categorical & Nominal \\                                                                              
  \hline                                                                                                                  
  2lSS & 70.6\% & 73.9\% \\
  3l & 76.1\% & 79.8\% \\
  \hline                                                                                                                 
  \end{tabular}                                                                                                           
  \label{tab:topMatchCatApx}
\end{table}

%---------------------------------------------------------------------- 
\subsection{Binary Classification of the Higgs $p_T$}
\label{subsec:binPtApx}
%---------------------------------------------------------------------- 
                                                                                                                     
A two bin fit of the Higgs momentum is used because statistics are insufficient for any finer resolution. This means separating high and low $p_T$ events is sufficient for this analysis. As such, rather than attempting the reconstruct the full Higgs $p_T$ spectrum, a binary classification approach is explored.

A model is built to determine whether $t\bar{t}H$ events include a high $p_T$ ($>$150 GeV) or low $p_T$ ($<$150 GeV) Higgs Boson. While this is now a classification model, it uses the same input features described in section \ref{sec:ptReco}. Binary crossentropy is used as the loss function.

\begin{figure}[H]                                                                                                           
  \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop2lSS/bin_keras_score.png}}%                
  \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop2lSS/bin_keras_roc.png}}\\
  \caption{Output distribution of the NN score for the binary high/low $p_T$ separation model in the $2lSS$ channel.}
  \label{fig:bin2lSSroc}                                                                          
\end{figure}

\begin{figure}[H]
  \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop3lS/bin_keras_score.png}}%                               
  \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop3lS/bin_keras_roc.png}}\\                                
  \caption{Output distribution of the NN score for the binary high/low $p_T$ separation model in the $3lS$ channel.}
  \label{fig:bin3lSroc}
\end{figure} 

\begin{figure}[H]
  \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop3lF/bin_keras_score.png}}%                               
  \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop3lF/bin_keras_roc.png}}\\                                
  \caption{Output distribution of the NN score for the binary high/low $p_T$ separation model in the $3lS$ channel.}
  \label{fig:bin3lFroc}
\end{figure} 

%----------------------------------------------------------------------
\subsection{Impact of Alternative Jet Selection}
\label{subsec:ptCutApx}
%---------------------------------------------------------------------- 

A relatively low $p_T$ threshold of 15 GeV is used to determine jet candidates, as the jets originating from the Higgs decay are found to fall between 15 and 25 GeV a large fraction of the time. The impact of different jet $p_T$ cuts on our ability to reconstruct the Higgs $p_T$ is explored here. 

The models are retrained in the $2lSS$ channel with the same parameters as those used in the nominal analysis, but the jet $p_T$ threshold is altered. The performance of the Higgs $p_T$ prediction models for jet $p_T$ cuts of 20 and 25 GeV are shown below.

\begin{figure}[H]
    \centering
    \textbf{Jet $p_T > 20$ GeV}
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop2lSS_20/keras_test_pt_scatter.png}}%            
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop2lSS_20/keras_test_norm2Dhist.png}}\\           
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop2lSS_20/keras_score.png}}%   
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop2lSS_20/keras_roc.png}}\\                       
    \caption{Output of the model designed to predict the Higgs momentum in the $2lSS$ channel, with the jet $p_T$ cutoff used is raised to 20 GeV.}
    \label{fig:pt2lSS_20}
\end{figure} 

\begin{figure}[H]
    \centering
    \textbf{Jet $p_T > 25$ GeV}
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop2lSS_20/keras_test_pt_scatter.png}}%                   
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop2lSS_20/keras_test_norm2Dhist.png}}\\
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop2lSS_20/keras_score.png}}%                             
    \subfigure[]{\includegraphics[width=.48\linewidth]{ptReco/higgsTop2lSS_20/keras_roc.png}}\\
    \caption{Output of the model designed to predict the Higgs momentum in the $2lSS$ channel, with the jet $p_T$ cutoff used is raised to 25 GeV.}
    \label{fig:pt2lSS_25}
\end{figure}

%----------------------------------------------------------------------

%----------------------------------------------------------------------
\subsection{Higgs Reconstruction Model Details}
\label{subsec:recoApx}
%----------------------------------------------------------------------

\subsubsection{b-jet Identification Features - 2lSS}
\include{sections/tables/texPlots_top2lSS}

\subsubsection{b-jet Identification Features - 3l}
\include{sections/tables/texPlots_top3l}

\subsubsection{Higgs Reconstruction Features - 2lSS}
\include{sections/tables/texPlots_higgs2lSS}

\subsubsection{Higgs Reconstruction Features - 3lS}
\include{sections/tables/texPlots_higgs3lS}

\subsubsection{Higgs Reconstruction Features - 3lF}
\include{sections/tables/texPlots_higgs3lF}

%----------------------------------------------------------------------

%----------------------------------------------------------------------
\subsection{Background Rejection MVA Details}
\label{subsec:sigBkgApx}
%----------------------------------------------------------------------

\subsubsection{Background Rejection MVA Features - 2lSS}
\label{apx:sigBkg2lSS}
\include{sections/tables/texPlots_sigBkg2lSS}

\subsubsection{Background Rejection MVA Features - 3l}
\label{apx:sigBkg3l}
\include{sections/tables/texPlots_sigBkg3l}

%----------------------------------------------------------------------
